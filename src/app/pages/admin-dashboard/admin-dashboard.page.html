<section class="relative w-full pb-16 pt-0">
  <div class="pointer-events-none absolute inset-0 -z-10 overflow-hidden">
    <div
      class="absolute -left-32 top-10 h-72 w-72 rounded-full bg-primary/20 blur-[90px] sm:h-96 sm:w-96"></div>
    <div
      class="absolute -right-24 bottom-0 h-80 w-80 rounded-full bg-emerald-400/20 blur-[110px] sm:h-[28rem] sm:w-[28rem]"></div>
  </div>

  <div class="admin-layout grid gap-6" [class.sidebar-collapsed]="isSidebarCollapsed">
    <aside
      class="sidebar-panel flex h-full flex-col rounded-3xl border border-white/10 bg-white/5 p-4 shadow-[0_0_40px_rgba(0,0,0,0.25)] backdrop-blur-xl sm:p-5"
      [class.is-collapsed]="isSidebarCollapsed">
      <div class="sidebar-header flex items-center justify-between gap-3">
        <div class="sidebar-brand flex items-center gap-3">
          <span class="material-symbols-outlined text-[26px] text-primary">settings</span>
          <div class="sidebar-text">
            <p class="text-xs font-semibold uppercase tracking-[0.2em] text-primary/80">Admin</p>
            <p class="text-base font-black text-white">Vezérlőpult</p>
          </div>
        </div>
        <div class="sidebar-toggle-wrap flex items-center gap-2">
          <button
            class="sidebar-toggle inline-flex items-center justify-center rounded-full border border-white/10 bg-white/5 p-2 text-gray-200 transition hover:border-primary/40 hover:text-white"
            type="button"
            aria-label="Oldalsáv"
            [attr.aria-pressed]="!isSidebarCollapsed"
            (click)="toggleSidebar()">
            <span class="material-symbols-outlined text-[18px]">dock_to_left</span>
          </button>
        </div>
      </div>

      <p class="sidebar-text mt-4 text-sm text-gray-300">
        <!-- Navigációs sáv a fő admin feladatokhoz. -->
      </p>

      <!-- <div class="sidebar-card mt-5 rounded-2xl border border-white/10 bg-background-dark/70 p-4">
        <div class="flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.2em] text-gray-400">
          <span class="material-symbols-outlined text-[14px] text-primary/80">verified</span>
          <span class="sidebar-label">Státusz</span>
        </div>
        <p class="sidebar-label mt-3 text-sm font-semibold text-white">Jogosultság rendben</p>
        <p class="sidebar-label mt-1 text-xs text-gray-400">Site-admin hozzáférés aktív</p>
      </div> -->

      <div class="mt-6">
        <div class="flex items-center justify-between px-2">
          <!-- <div class="flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.2em] text-gray-400">
            <span class="material-symbols-outlined text-[16px] text-primary/80">menu</span>
            <span class="sidebar-label">Menü</span>
          </div> -->
          <!-- <span class="sidebar-chevron material-symbols-outlined text-[18px] text-gray-400">expand_more</span> -->
        </div>
        <div class="sidebar-scroll mt-3 max-h-[52vh] overflow-y-auto pl-2">
          <div class="sidebar-scroll-content">
            <button
              class="sidebar-item flex w-full items-center justify-between rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-left text-sm font-semibold text-gray-200 transition hover:border-primary/40 hover:bg-white/10 hover:text-white"
              type="button"
              [class.is-active]="activeSection === 'groups'"
              (click)="setSection('groups')">
              <span class="flex items-center gap-3">
                <span class="material-symbols-outlined text-[20px] text-primary">groups</span>
                <span class="sidebar-label">Csoportok</span>
              </span>
              <span class="sidebar-chevron material-symbols-outlined text-[18px] text-gray-400">chevron_right</span>
            </button>
            <button
              class="sidebar-item mt-2 flex w-full items-center justify-between rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-left text-sm font-semibold text-gray-200 transition hover:border-primary/40 hover:bg-white/10 hover:text-white"
              type="button">
              <span class="flex items-center gap-3">
                <span class="material-symbols-outlined text-[20px] text-primary">person</span>
                <span class="sidebar-label">Felhasználók</span>
              </span>
              <span class="sidebar-chevron material-symbols-outlined text-[18px] text-gray-400">chevron_right</span>
            </button>
            <button
              class="sidebar-item mt-2 flex w-full items-center justify-between rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-left text-sm font-semibold text-gray-200 transition hover:border-primary/40 hover:bg-white/10 hover:text-white"
              type="button">
              <span class="flex items-center gap-3">
                <span class="material-symbols-outlined text-[20px] text-primary">query_stats</span>
                <span class="sidebar-label">Statisztikák</span>
              </span>
              <span class="sidebar-chevron material-symbols-outlined text-[18px] text-gray-400">chevron_right</span>
            </button>
            <button
              class="sidebar-item mt-2 flex w-full items-center justify-between rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-left text-sm font-semibold text-gray-200 transition hover:border-primary/40 hover:bg-white/10 hover:text-white"
              type="button">
              <span class="flex items-center gap-3">
                <span class="material-symbols-outlined text-[20px] text-primary">chat_bubble</span>
                <span class="sidebar-label">Üzenetek</span>
              </span>
              <span class="sidebar-chevron material-symbols-outlined text-[18px] text-gray-400">chevron_right</span>
            </button>
            <!-- <div class="sidebar-card mt-4 rounded-2xl border border-white/10 bg-white/5 p-4">
              <div class="flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.2em] text-gray-400">
                <span class="material-symbols-outlined text-[14px] text-primary/80">note_alt</span>
                <span class="sidebar-label">Megjegyzés</span>
              </div>
              <p class="sidebar-label mt-2 text-sm text-gray-300">
                Új aloldalak hamarosan. Addig csak a struktúra látszik.
              </p>
            </div> -->
          </div>
        </div>
      </div>

      <div class="mt-auto pt-6">
        <div class="sidebar-card rounded-2xl border border-white/10 bg-background-dark/70 p-4">
          <div class="flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.2em] text-gray-400">
            <span class="material-symbols-outlined text-[14px] text-primary/80">schedule</span>
            <span class="sidebar-label">Emlékeztető</span>
          </div>
          <p class="sidebar-label mt-2 text-sm text-gray-300">Legutóbbi belépés: --</p>
        </div>
      </div>
    </aside>

    <div class="admin-main pt-10 pr-4 sm:pr-6 lg:pr-8">
      <div class="mx-auto flex max-w-7xl flex-col gap-6">
        <ng-container *ngIf="activeSection === 'overview'">
      <div
        class="rounded-3xl border border-white/10 bg-white/5 p-6 shadow-[0_0_40px_rgba(0,0,0,0.25)] backdrop-blur-xl sm:p-8">
        <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
          <div>
            <div class="flex items-center gap-3 text-sm font-semibold uppercase tracking-[0.2em] text-primary/80">
              <span class="material-symbols-outlined text-[22px]">admin_panel_settings</span>
              Site Admin
            </div>
            <h1 class="mt-3 text-3xl font-black text-white sm:text-4xl">Admin irányítópult</h1>
            <p class="mt-2 max-w-2xl text-sm text-gray-300">
              Zárt terület. Itt készülnek az új admin modulok és áttekintések.
            </p>
          </div>
          <div class="flex flex-wrap items-center gap-2">
            <button
              class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/10 px-4 py-2 text-xs font-semibold uppercase tracking-[0.2em] text-gray-200 transition hover:border-primary/40 hover:text-white"
              type="button">
              <span class="material-symbols-outlined text-[18px]">shield</span>
              Ellenőrzés
            </button>
          </div>
        </div>
      </div>

      <div class="grid gap-4 sm:grid-cols-2 xl:grid-cols-4">
        <div class="rounded-2xl border border-white/10 bg-background-dark/60 p-4">
          <p class="text-xs font-semibold uppercase tracking-[0.2em] text-gray-400">Felhasználók</p>
          <p class="mt-4 text-2xl font-black text-white">--</p>
          <p class="mt-2 text-xs text-gray-400">Aktív regisztrációk</p>
        </div>
        <div class="rounded-2xl border border-white/10 bg-background-dark/60 p-4">
          <p class="text-xs font-semibold uppercase tracking-[0.2em] text-gray-400">Csoportok</p>
          <p class="mt-4 text-2xl font-black text-white">--</p>
          <p class="mt-2 text-xs text-gray-400">Kiemelt közösségek</p>
        </div>
        <div class="rounded-2xl border border-white/10 bg-background-dark/60 p-4">
          <p class="text-xs font-semibold uppercase tracking-[0.2em] text-gray-400">Statisztikák</p>
          <p class="mt-4 text-2xl font-black text-white">--</p>
          <p class="mt-2 text-xs text-gray-400">Frissítés alatt</p>
        </div>
        <div class="rounded-2xl border border-white/10 bg-background-dark/60 p-4">
          <p class="text-xs font-semibold uppercase tracking-[0.2em] text-gray-400">Üzenetek</p>
          <p class="mt-4 text-2xl font-black text-white">--</p>
          <p class="mt-2 text-xs text-gray-400">Beérkező csatornák</p>
        </div>
      </div>

      <div class="grid gap-6 lg:grid-cols-3">
        <div class="rounded-2xl border border-white/10 bg-background-dark/60 p-5 lg:col-span-2">
          <div class="flex items-center justify-between">
            <h2 class="text-lg font-bold text-white">Gyors műveletek</h2>
            <span class="text-xs font-semibold uppercase tracking-[0.2em] text-gray-400">Placeholder</span>
          </div>
          <div class="mt-4 grid gap-3 sm:grid-cols-2">
            <button
              class="flex items-center justify-between rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-gray-200 transition hover:border-primary/40 hover:text-white"
              type="button">
              Moderációs listák
              <span class="material-symbols-outlined text-[18px]">flag</span>
            </button>
            <button
              class="flex items-center justify-between rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-gray-200 transition hover:border-primary/40 hover:text-white"
              type="button">
              Rendszer Üzenetek
              <span class="material-symbols-outlined text-[18px]">campaign</span>
            </button>
            <button
              class="flex items-center justify-between rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-gray-200 transition hover:border-primary/40 hover:text-white"
              type="button">
              Felhasználó tiltás
              <span class="material-symbols-outlined text-[18px]">block</span>
            </button>
            <button
              class="flex items-center justify-between rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-gray-200 transition hover:border-primary/40 hover:text-white"
              type="button">
              Audit napló export
              <span class="material-symbols-outlined text-[18px]">download</span>
            </button>
          </div>
        </div>

        <div class="rounded-2xl border border-white/10 bg-background-dark/60 p-5">
          <h2 class="text-lg font-bold text-white">Hozzáférés</h2>
          <p class="mt-3 text-sm text-gray-300">
            Ez a panel a site-admin flag alapján érhető el a profil dokumentumban.
          </p>
          <div class="mt-4 rounded-xl border border-white/10 bg-white/5 p-4 text-xs text-gray-400">
            Kötelező mező: <span class="text-white">role: 'siteadmin'</span>
          </div>
        </div>
      </div>
        </ng-container>
        <ng-container *ngIf="activeSection === 'groups'">
          <div
            class="rounded-3xl border border-white/10 bg-white/5 p-6 shadow-[0_0_40px_rgba(0,0,0,0.25)] backdrop-blur-xl sm:p-8">
            <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
              <div>
                <div class="flex items-center gap-3 text-sm font-semibold uppercase tracking-[0.2em] text-primary/80">
                  <span class="material-symbols-outlined text-[22px]">groups</span>
                  Csoportok
                </div>
                <h1 class="mt-3 text-3xl font-black text-white sm:text-4xl">Aktív csoportok</h1>
                <p class="mt-2 max-w-2xl text-sm text-gray-300">
                  Itt látod a jelenlegi közösségeket és kezelheted a csoport adatlapokat.
                </p>
              </div>
              <div class="flex flex-col items-start gap-2 sm:items-end">
                <button
                  class="inline-flex items-center gap-2 rounded-full bg-primary px-4 py-2 text-xs font-semibold uppercase tracking-[0.2em] text-white shadow-[0_0_18px_rgba(16,185,129,0.6)] transition hover:bg-emerald-300 disabled:cursor-not-allowed disabled:opacity-70"
                  type="button"
                  [disabled]="isQuerying"
                  (click)="runQuery()">
                  <span class="material-symbols-outlined text-[18px]">bolt</span>
                  Lekérdezés
                </button>
                <button
                  class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/10 px-4 py-2 text-xs font-semibold uppercase tracking-[0.2em] text-gray-200 transition hover:border-primary/40 hover:text-white"
                  type="button"
                  (click)="setSection('overview')">
                  <span class="material-symbols-outlined text-[18px]">arrow_back</span>
                  Áttekintés
                </button>
              </div>
            </div>
          </div>

          <div class="rounded-2xl border border-white/10 bg-background-dark/60 p-4 sm:p-6">
            <div class="mb-4 flex flex-wrap items-center justify-between gap-3">
              <h2 class="text-lg font-bold text-white">Csoport lista</h2>
              <div class="flex flex-wrap items-center gap-3 text-xs font-semibold uppercase tracking-[0.2em] text-gray-400">
                <span>Osszesen: {{ groups.length }}</span>
                <label class="flex items-center gap-2">
                  <span>Oldal meret</span>
                  <select
                    class="rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-semibold text-gray-200"
                    [value]="pageSize"
                    (change)="setPageSize($any($event.target).valueAsNumber)">
                    <option *ngFor="let size of pageSizeOptions" [value]="size">{{ size }}</option>
                  </select>
                </label>
                <div class="flex items-center gap-2">
                  <span>Oldal: {{ currentPage }} / {{ totalPages }}</span>
                  <button
                    class="inline-flex items-center justify-center rounded-full border border-white/10 bg-white/5 p-2 text-gray-200 transition hover:border-primary/40 hover:text-white disabled:cursor-not-allowed disabled:opacity-60"
                    type="button"
                    [disabled]="currentPage === 1"
                    (click)="goToPage(currentPage - 1)">
                    <span class="material-symbols-outlined text-[18px]">chevron_left</span>
                  </button>
                  <button
                    class="inline-flex items-center justify-center rounded-full border border-white/10 bg-white/5 p-2 text-gray-200 transition hover:border-primary/40 hover:text-white disabled:cursor-not-allowed disabled:opacity-60"
                    type="button"
                    [disabled]="currentPage === totalPages"
                    (click)="goToPage(currentPage + 1)">
                    <span class="material-symbols-outlined text-[18px]">chevron_right</span>
                  </button>
                </div>
              </div>
            </div>
            <ng-container *ngIf="groups.length > 0; else emptyState">
              <div class="overflow-x-auto">
                <table class="min-w-full border-separate border-spacing-y-2 text-left text-sm">
                  <thead class="text-xs uppercase tracking-[0.2em] text-gray-400">
                    <tr>
                      <th class="px-4 py-2">Csoport neve</th>
                      <th class="px-4 py-2">Létrehozó</th>
                      <th class="px-4 py-2">Létrehozva</th>
                      <th class="px-4 py-2 text-center">Tagok</th>
                      <th class="px-4 py-2 text-center">Események</th>
                      <th class="px-4 py-2">Utolsó esemény</th>
                      <th class="px-4 py-2 text-right">Műveletek</th>
                    </tr>
                  </thead>
                  <tbody class="text-gray-200">
                    <tr
                      *ngFor="let group of pagedGroups"
                      class="rounded-2xl border border-white/10 bg-white/5">
                      <td class="px-4 py-3 font-semibold text-white">{{ group.name }}</td>
                      <td class="px-4 py-3">{{ group.creator }}</td>
                      <td class="px-4 py-3">{{ group.createdAt }}</td>
                      <td class="px-4 py-3 text-center">{{ group.memberCount }}</td>
                      <td class="px-4 py-3 text-center">{{ group.eventCount }}</td>
                      <td class="px-4 py-3">{{ group.lastEventAt }}</td>
                      <td class="px-4 py-3 text-right">
                        <div class="flex items-center justify-end gap-2">
                          <button
                            class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-primary px-3 py-2 text-xs font-semibold uppercase tracking-[0.2em] text-gray-200 transition hover:border-primary/40 hover:text-white"
                            type="button"
                            (click)="editGroup(group.id)">
                            <span class="material-symbols-outlined text-[16px]">edit</span>
                            Szerkesztés
                          </button>
                          <button
                            class="inline-flex items-center gap-2 rounded-full border border-rose-400/40 bg-red-500 px-3 py-2 text-xs font-semibold uppercase tracking-[0.2em] text-rose-100 transition hover:border-rose-300 hover:text-white"
                            type="button"
                            (click)="confirmDeleteGroup(group.id)">
                            <span class="material-symbols-outlined text-[16px]">delete</span>
                            Törlés
                          </button>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </ng-container>
            <ng-template #emptyState>
              <div class="rounded-2xl border border-dashed border-white/10 bg-white/5 px-6 py-10 text-center">
                <span class="material-symbols-outlined text-[32px] text-primary/80">search</span>
                <p class="mt-3 text-sm font-semibold text-white">
                  {{ hasQueried ? 'Nincs találat a lekért adatok közöt.' : 'Nincs betöltött adat, indíts lekérdezést.' }}
                </p>
                <p class="mt-2 text-xs text-gray-400">
                  {{ hasQueried ? 'Próbálj meg új lekérdezést később.' : 'A cache csak a Lekérdezés gombbal frissül.' }}
                </p>
              </div>
            </ng-template>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</section>
